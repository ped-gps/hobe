<div id="clients">
	<header>
		<div class="title">
			<h1>Pacientes</h1>
		</div>
	</header>

	<main>
		<div class="filters-actions">
			<div class="filters">
				<div class="filter">
					<div class="input name">
						<p-iconfield>
							<input
								pInputText
								type="text"
								placeholder="Pesquisar"
								[(ngModel)]="textFilter"
								(input)="onInputChange()"
							/>
							<p-inputicon styleClass="pi pi-search" />
						</p-iconfield>
					</div>
				</div>
			</div>

			<div class="actions">
				<div class="action">
					<p-button
						label="Adicionar paciente"
						class="button-blue-white button-icon-end"
						(onClick)="onAddClient()"
					>
						<span class="material-symbols-rounded">add</span>
					</p-button>
				</div>
			</div>
		</div>

		<div class="table">
			<p-table
				[value]="clients"
				[rows]="size"
				[totalRecords]="totalElements"
				[lazy]="true"
				[paginator]="true"
				[scrollable]="true"
				[loading]="isLoading"
				[first]="page * size"
				[sortField]="'name'"
				(onPage)="onPageChange($event)"
				(onSort)="onSortChange($event)"
			>
				<ng-template #header>
					<tr>
						<th
							pSortableColumn="name"
							style="width: 40%; text-align: center"
						>
							Nome <p-sortIcon field="name" />
						</th>
						<th
							pSortableColumn="email"
							style="width: 30%; text-align: center"
						>
							E-mail <p-sortIcon field="email" />
						</th>

						<th
							pSortableColumn="phone"
							style="width: 20%; text-align: center"
						>
							Telefone <p-sortIcon field="phone" />
						</th>
						<th style="width: 10%; text-align: center">Ações</th>
					</tr>
				</ng-template>
				<ng-template #body let-client>
					<tr class="procedure">
						<td style="text-align: left">
							<span class="client-name">
								{{ client.name }}
							</span>
						</td>
						<td style="text-align: center">
							<span class="client-emai">
								{{ client.email }}
							</span>
						</td>
						<td style="text-align: center">
							<span class="client-value">
								{{ client.phone | phone }}
							</span>
						</td>
						<td style="text-align: center">
							<p-button
								class="button-transparent-gray button-icon"
								[rounded]="true"
								[text]="true"
								[loading]="isSubmitting"
								(onClick)="
									selectedClient = client;
									clientMenu.toggle($event)
								"
							>
								<span class="material-symbols-rounded">
									more_vert
								</span>
							</p-button>
						</td>
					</tr>
				</ng-template>
				<ng-template #emptymessage>
					<tr>
						<td colspan="4" style="text-align: center">
							Nenhum registro encontrado
						</td>
					</tr>
				</ng-template>
			</p-table>
		</div>
	</main>
</div>

<p-menu
	#clientMenu
	appendTo="body"
	[popup]="true"
	[model]="clientMenuOptions"
/>
