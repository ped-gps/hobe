<div id="medical-appointments-extract">
	<header>
		<div class="title">
			<h1>Extrato de Atendimentos</h1>
		</div>
	</header>

	<main>
		@if (user) {
			<div class="filters">
				@if (user.profile === UserProfile.PARTNER) {
					<div class="filter health-professional">
						<label for="healthProfessional">Profissional</label>
						<p-select
							[options]="healthProfessionalsOptions"
							placeholder="Selecione"
							[(ngModel)]="selectedHealthProfessional"
							(onChange)="onHealthProfessionalChange()"
						/>
					</div>
				}

				<div class="filter period">
					<label for="period">Per√≠odo</label>
					<p-datepicker
						appendTo="body"
						placeholder="Selecione"
						dateFormat="dd/mm/yy"
						selectionMode="range"
						[(ngModel)]="selectedPeriod"
						(onSelect)="onPeriodChange()"
					/>
				</div>
			</div>

			<div class="table">
				<p-table [value]="medicalAppointments" [loading]="isLoading">
					<ng-template #caption>
						<div class="actions">
							<div class="action">
								<p-button
									label="Imprimir"
									icon="pi pi-print"
									iconPos="right"
									class="button-outline-gray"
									(onClick)="onPrintPress()"
								/>
							</div>
						</div>
					</ng-template>
					<ng-template #header>
						<tr>
							<th style="width: 15%; text-align: center">Data</th>
							<th style="width: 30%; text-align: center">
								Paciente
							</th>
							<th style="width: 30%; text-align: center">
								Procedimento
							</th>
							<th style="width: 10%; text-align: center">
								Valor
							</th>
							<th style="width: 10%; text-align: center">
								Repasse
							</th>
						</tr>
					</ng-template>
					<ng-template #body let-medicalAppointment>
						<tr>
							<td style="text-align: center">
								{{
									medicalAppointment.createdDate
										| date: "dd/MM/yyyy HH:mm"
								}}
							</td>
							<td style="text-align: start">
								{{ medicalAppointment.client.name }}
							</td>
							<td style="text-align: start">
								{{ getProcedureName(medicalAppointment) }}
							</td>
							<td style="text-align: center">
								{{
									getProcedureValue(medicalAppointment)
										| currency
								}}
							</td>
							<td style="text-align: center">
								{{ medicalAppointment.payoutTotal | currency }}
							</td>
						</tr>
					</ng-template>
					<ng-template #emptymessage>
						<tr>
							<td colspan="5" style="text-align: center">
								Nenhum registro encontrado
							</td>
						</tr>
					</ng-template>
				</p-table>

				<div class="payout-total">
					<span class="label"
						>Total {{ payoutTotal | currency }}</span
					>
				</div>
			</div>
		} @else {
			<app-loading />
		}
	</main>
</div>
